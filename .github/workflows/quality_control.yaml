name: ğŸ§ª Code Quality Assurance

on:
  pull_request:          # ğŸ¯ Trigger on pull requests
    branches:
      - main            # ğŸ”± Main branch protection

jobs:
  validate_shell:       # ğŸ” Shell script validation
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ“¥ Checkout Repository
        uses: actions/checkout@v4

      - name: ğŸ›¡ï¸ Run ShellCheck Analysis
        uses: ludeeus/action-shellcheck@master
        # ğŸ”¬ Validates shell scripts against coding standards

  flutter_coverage:     # ğŸ“Š Flutter coverage analysis
    runs-on: ubuntu-latest
    permissions:
      contents: write    # ğŸ“ Allow content modifications
      pull-requests: write  # ğŸ’¬ Enable PR comments
      pages: write      # ğŸ“ƒ GitHub Pages deployment
    steps:
      - name: ğŸ“¦ Checkout Repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0  # ğŸ“š Full history for accurate coverage

      - name: ğŸ“ˆ Generate Coverage Report
        id: flutter-coverage
        uses: ./
        with:
          coverage_base_dir: 'example'    # ğŸ“ Coverage source directory
          max_reports: '100'              # ğŸ“Š Maximum reports to retain
          debug_mode: '1'                 # ğŸ› Enable debugging
          comment_on_pr: 'true'           # ğŸ’­ Post coverage comments
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}  # ğŸ”‘ Authentication token